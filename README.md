# cmb-spectra
Code to compute CMB primordial power spectrum for multi-field cosmological inflation models

BACKGROUND INFO, SKIP TO NEXT SECTION FOR DETAILS OF THE CODE:

Cosmological inflation posits a period of rapid, accelerated expansion of the universe very early in its history (~10^{-35} seconds after the Big Bang). This early expansion has several theoretical motivations, the primary being our best solution to the Horizon Problem (https://en.wikipedia.org/wiki/Horizon_problem). Long story short, the temperature of the cosmic microwave background (CMB, https://en.wikipedia.org/wiki/Cosmic_microwave_background) permeating the entire universe that we observe today is nearly uniform across all directions of the sky. Why is this a problem, you may ask? The thing is, the universe is big. REALLY big. So big that most places in the universe aren't in casual contact, i.e. a signal moving at the speed of light from one place at an early time could not have reached the other place at any later time up through today.

In physics, a really big object at a constant temperature everywhere within its extent is thermalized, meaning that each part of it is in thermal equilibrium with every other part. Thermal equilibrium requires physical interactions between every part of the object as they exchange thermal energy with each other. However, these interactions don't happen instantaneously - at best, they travel at the speed of light! So if the object is big enough, some parts of it can't "talk" to other parts in a given timescale, and hence there's no physical reason why those two parts should be at the same temperature. This is the Horizon Problem in a nutshell - why does the CMB have the same temperature everywhere if most parts of it are too far away from each other to have thermalized within the universe's lifespan? 

Inflation predicts that everything in the universe was actually much closer to each other at early times than we previously thought. This ensures that each region of the observable universe could interact and thermalize with all other regions. In order for this tinier-than-expected size of the observable universe to be as big as it is today, inflation proposes that a rapid expansion process took this tiny, thermalized early universe and blew it up to a massive size that fits our current cosmological data. Obligatory reminder: Inflation != Big Bang. They are two different theories that involve an expanding universe, though inflation generally assumes some sort of Big Bang occurred before it.

This is a pretty picture that explains why the CMB has nearly the same temperature everywhere... wait, what was that about "nearly" the same temperature? Truthfully, there are small temperature fluctuations that we observe at different points in the CMB. They roughly obey \delta T / T ~ 10^{-5}. So these fluctuations are quite tiny, but we still want to understand why they exist when inflation should have smoothed out the CMB's temperature very effectively. Their origin lies in the quantum-mechanical fluctuations that the early, tiny universe exhibited. Although the early universe was thermalized due to interactions within itself, quantum fluctuations can create little "pockets" in which the temperature differs slightly from their surroundings. These slight differences in turn get blown up when the universe inflates, and they manifest as the miniscule temperature fluctuations in the CMB we see today. This means that the early universe's quantum-mechanical dynamics, which generally govern small objects like subatomic particles, have direct implications for what we observe in cosmological data on the largest length scales!

OVERVIEW OF THE CODE:

The goal of this code is to simulate and model these quantum-mechanical fluctuations in the early universe in the framework of cosmological perturbation theory. In models of inflation with more than one quantum-mechanical degree of freedom (generally speaking, many quantum fields), the fluctuations are classified into a single adiabatic (entropy-preserving) fluctuation and the remaining entropic (entropy-changing) fluctuations. We follow the notation of https://arxiv.org/abs/2012.02761 and https://arxiv.org/abs/2304.00065, in which \zeta is the (adiabatic) curvature perturbation and Q_s is the entropic perturbation. Both are represented in Fourier space and thus are analyzed in a mode-by-mode manner. The code computes the primordial power spectrum, i.e. the two-point correlation function of each perturbation's Fourier modes of a given scale, k. The power spectrum is computed for individual modes as a function of time, and for a set of modes on CMB length-scales as a function of k. Recall that the wavenumber k corresponds to a momentum scale, and the Fourier-space relation k ~ 1/\lambda correlates a length scale \lambda with each k.

We define the equations of motion governing the two types of perturbations and solve them simultaneously to determine how they evolve over time during inflation. We use e-foldings of the cosmic scale factor, N such that a(N) = a_ini * exp(N), as our time coordinate of choice for maximum numerical efficiency. We impose Bunch-Davies initial conditions on both perturbations' real and imaginary parts to ensure that they behave as Minkowski-space harmonic oscillators at sufficiently early times. The initial conditions are imposed ~8 e-folds before the CMB mode exits the Hubble horizon, i.e. begins to freeze in its evolution. Note that we employ the multi-field quantization procedure described in https://arxiv.org/abs/1207.0317, which eliminates any spurious interference between the initally independent perturbations.

We also include the possibility of a temporary coupling, \omega, between \zeta and Q_s in the form of a sharply peaked turning-rate profile. The term "turning-rate" comes from the geometrical picture of viewing the multiple fields' evolution as tracing out a trajectory in field-space. Geodesic trajectories involve no turning and correspond to two separate, effectively single-field perturbations. The turning rate \omega is defined in terms of the e-fold coordinate at which the profile peaks, and the half-width of the profile, \delta N. We use the terms "profile" and "feature" interchangeably in the code, as a nonzero turning rate can induce interesting features in the primordial power spectrum.

The code is split into several cells that can be run separately in Spyder.
